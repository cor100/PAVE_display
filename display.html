<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Test Display</title>
    <link rel="stylesheet" href="styles.css">
</head>
<script>
    function connectPhidgets(){
        fetch('test_csv.txt') 
        .then(response => response.text())
        .then(text => {
            var data = text.split("\n");
            var num = data[0].split(", ");
            
            document.getElementById("rudder").innerHTML = "rudder angle: " + num[0];
            var rudder = document.getElementsByClassName("rudderColor");
            rudder[0].style.width=(num[0]+"%");

            document.getElementById("throttle").innerHTML = "throttle: " + num[1];
            var throttle = document.getElementsByClassName("throttleColor");
            throttle[0].style.width=(num[1]+"%");

            const actualLeft = -77.190631;
            const actualTop = 38.690681;
            const actualWidth = 0.064825;
            const actualHeight = 0.024768;

            var buoy1Top = (Math.abs(parseInt(num[0]) - actualTop)) / actualHeight * 350 + top;
            var buoy1Left = (Math.abs(parseInt(num[0]) - actualLeft)) / actualWidth * 700 + left;
            var buoy2Top = (Math.abs(parseInt(num[0]) - actualTop)) / actualHeight * 350 + top;
            var buoy2Left = (Math.abs(parseInt(num[0]) - actualLeft)) / actualWidth * 700 + left;
            var boatTop = (Math.abs(parseInt(num[0]) - actualTop)) / actualHeight * 350 + top;
            var boatLeft = (Math.abs(parseInt(num[0]) - actualLeft)) / actualWidth * 700 + left;

            document.getElementById("boat").style.top=(200+"px");
            document.getElementById("boat").style.left=(boatLeft+"px");
            document.getElementById("buoy1").style.top=(buoy1Top+"px");
            document.getElementById("buoy1").style.left=(buoy1Left+"px");
            document.getElementById("buoy2").style.top=(buoy2Top+"px");
            document.getElementById("buoy2").style.left=(buoy2Left+"px");
        })
    }
</script>
    <body onload="connectPhidgets()">
        <section class = "container">
            <div class = "left-half">
                <table class = "center">
                    <tr>
                        <th>Get Set</th>
                        <th>Begin Race</th>
                        <th>End Race</th>
                        <th>Set Buoys</th>
                        <th>Donuts</th>
                    </tr>
                </table>
                <h1>TEST DISPLAY</h1>
                <h2 id="dataLabel">?</h2>
                <img src="Screen Shot 2022-04-26 at 1.38.26 PM.png" id="map">
                <div class="label" id="boat"></div>
                <div class="label buoy" id="buoy1"></div>
                <div class="label buoy" id="buoy2"></div>
            </div>
            <div class = "right-half">
                <table class = "center">
                    <tr>
                        <th><img src = "andlinger.png" class = "sponsor"></th>
                        <th><img src = "council.png" class = "sponsor"></th>
                        <th><img src = "keller.png" class = "sponsor"></th>
                    </tr>
                </table>
                <section>
                    <h1 id="throttle">
                        throttle
                    </h1>
                    <div class="progress">
                        <div class="throttleColor"></div>
                      </div>                        
                      <h1 id="rudder">
                        rudder angle
                    </h1>
                    <div class="progress">
                        <div class="rudderColor"></div>
                      </div>                    
                    <h1>
                        control
                    </h1>
                    <table>
                        <tr>
                            <th>GPS</th>
                            <th>RC</th>
                            <th>Autonomous</th>
                        </tr>
                    </table>
                    <table>
                        <tr>
                            <th>GPS</th>
                            <th>RC</th>
                        </tr>
                    </table>>
                </section>
            </div>
        </section>
    </body>
</html>